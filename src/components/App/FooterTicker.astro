---
const copy = ["Let’s work together", "Please please?", "Shall we?"];
const multipleCopy: string[] = [...copy];
---

<!-- <section class="wrapper py-100">
  <div
    class:list={[
      "font-heading text-fluid-h1 font-semibold",
      "bg-yellow text-navy",
      "py-[1.25em] rounded-[1em]",
    ]}
  >
    {multipleCopy.map((text) => (
      <p>{text}</p>
    ))}
    Let’s work together
  </div>
</section> -->
<script>
  let isVisible = false;
  const container = document.querySelector(".block-marquee");

  const callback = (entries: any) => {
    const [{ isIntersecting }] = entries;

    isVisible = isIntersecting;

    if (isVisible) {
      container?.classList.add("is-visible");
    } else {
      container?.classList.remove("is-visible");
    }
    console.log("isVisible:", isVisible);
  };

  const options = {
    root: null,
    rootMargin: "0px 0px 0px 0px",
    threshold: 0,
  };

  const observer = new IntersectionObserver(callback, options);

  if (container) observer.observe(container);
</script>

<section class:list={["block-marquee contain-paint block w-full py-200"]}>
  <div class="block-marquee__wrapper">
    <div
      class="block-marquee__words block-marquee__words--right select-none flex gap-[var(--gap)] min-w-full font-heading text-fluid-h1 font-semibold"
    >
      <div
        class="block-marquee__group will-change-transform flex shrink-0 gap-[var(--gap)] items-center justify-around min-w-full"
      >
        {multipleCopy.map((text) => <p>{text}</p>)}
      </div>
    </div>
  </div>
</section>

<style>
  .block-marquee__words {
    --duration: 60s;
    --gap: 0.5em;

    padding: 0.15em;

    &--left {
      animation: auto linear scroll-left both;
      animation-play-state: paused;
      animation-timeline: view();

      animation-range: entry 0% cover 100%;
    }

    &--right {
      justify-content: flex-end;

      animation: auto linear scroll-right both;
      animation-play-state: paused;
      animation-timeline: view();

      animation-range: entry 0% cover 100%;
    }

    @media not (prefers-reduced-motion: reduce) {
      .block-marquee.is-visible & {
        animation-play-state: running;
      }
    }
  }

  .block-marquee__group {
    margin-block: -0.088em -0.181em;

    .block-marquee__words--left & {
      animation: ticker-left var(--duration) linear infinite;
      animation-play-state: paused;
    }

    .block-marquee__words--right & {
      animation: ticker-right var(--duration) linear infinite;
      animation-play-state: paused;
    }

    @media not (prefers-reduced-motion: reduce) {
      .block-marquee.is-visible & {
        animation-play-state: running;
      }
    }
  }

  @keyframes scroll-left {
    from {
      translate: 0% 0 0;
    }

    to {
      translate: -25% 0 0;
    }
  }

  @keyframes scroll-right {
    from {
      translate: 0% 0 0;
    }

    to {
      translate: 25% 0 0;
    }
  }

  @keyframes ticker-left {
    0% {
      translate: 0 0 0;
    }

    100% {
      translate: calc(-100% - var(--gap)) 0 0;
    }
  }

  @keyframes ticker-right {
    0% {
      translate: 0 0 0;
    }

    100% {
      translate: calc(100% + var(--gap)) 0 0;
    }
  }
</style>
